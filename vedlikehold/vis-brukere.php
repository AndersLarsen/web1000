<?php /** * VISER ALLE BRUKERE * GIR DEG MULIGHETEN Å SØKE I BRUKERE TABELLEN * GIR DEG MULIGHET Å SLETTE BRUKERE * GIR DEG MULIGHET Å ENDRE BRUKER INFORMASJON * * PHP version 5 * * LICENSE: This source file is subject to version 3.01 of the PHP license * that is available through the world-wide-web at the following URI: * http://www.php.net/license/3_01.txt.  If you did not receive a copy of * the PHP License and are unable to obtain it through the web, please * send a note to license@php.net so we can mail you a copy immediately. * * @author		Original Author <andersborglarsen@gmail.com> * @author		Original Author <haavard@ringshaug.net> * @author		Original Author <oyvind.gautestad@gmail.com> * @author		Original Author <linda.fermann@gmail.com> * @copyright 	2013-2018 * @license		http://www.php.net/license/3_01.txt * @link		http://student.hive.no/web10007/1 * */$title = 'Vis brukere - roomEdit';include '../includes/headerVedlikehold.php';			// INKLUDERER HEADER checkLogin();											// KJØRER SJEKK LOGIN SKRIPTcheckAdmin();											//SJEKKER OM EN BRUKER HAR ADMIN STATUS?>																					<!-- BYGGER SØKE FELTET --><fieldset><legend>Søk på brukernavn </legend><form class="" name="searchForm" id="searchForm" action="" method="post">	<label for="searchType">Søk</label>	<input type="text" type="text" name="searchBox" id="searchBox" placeholder=" brukernavn">	<input class="submit" type="submit" value="Søk" name="searchButton" id="searchButton"></form></fieldset>		<?php /****************************** SØk ****************************************/$searchType=$_POST["searchType"];													//HENTER INN SUBMIT KNAPPENE FRA SKJEAM$searchButton=$_POST["searchButton"];$searchBox=$_POST["searchBox"];$date=$_POST["date"];if($searchButton){																	//NÅR MAN TRYKKER PÅ KNAPPEN																					//TABELLEN SKRIVES UT				if(strpos($searchType,'user') !== false){		$column="Username";	}		connect(); 		$sql="SELECT * FROM user WHERE username LIKE '$searchBox%';";							// SØKER I DATABASEN ETTER NOE SOM ER LIK SOM ELLER LIKHET SOM	$result = mysql_query($sql) or die ("ikke mulig å søke i databasen");					// LAGRER SVARET	$numRows = mysql_num_rows($result);														// RETURNERER FUNN		if($numRows == 0) {		echo "Ingen brukere matcher ditt søk";	} else {		echo " 		<table class='standard_table'>		<thead>			<tr>				<th></th>				<th class='standard_table_header' align=left>Id</th>				<th class='standard_table_header' align=left>Brukernavn</th>				<th class='standard_table_header' align=left>E-post</th>				<th class='standard_table_header' align=left>Brukergruppe</th>				<th class='standard_table_header' align=left>Admin</th>				<th class='standard_table_header' align=left>Brukerref.</th>				<th></th>				<th></th>			</tr>		</thead>		<tbody> 		";			for($t=1; $t<=$numRows; $t++){		$row=mysql_fetch_array($result);													// DELER ARRAY UT I RADER		$userId = $row[0];																		//LAGRER USERID INPUT I VARIABLEN FRA SKJEMA	$username = $row[1];																	//LAGRER USERNAME INPUT I VARIABLEN FRA SKJEMA	$mail = $row[2];																		//LAGRER MAIL INPUT I VARIABLEN FRA SKJEMA	$position_id = $row[4];																	//LAGRER POSISJON INPUT I VARIABLEN FRA SKJEMA	$admin=$row[5];																			//LAGRER ADMIN INPUT I VARIABLEN FRA SKJEMA	$ref_users=$row[6];																		//LAGRER USERREF INPUT I VARIABLEN FRA SKJEMA		if($position_id==1) {																	// GIR POSISJONS ID ET MER LESLIG NAVN		$position_id = 'Ansatt';	} elseif ($position_id==2) {		$position_id = 'Student';	} 		if ($admin==1) {																		// GIR ADMINSTATUS ET BEDRE NAVN		$admin = 'Ja';	} else {		$admin = 'Nei';	}			echo " 		<tr><tr>		<form method='post' action='endre-bruker.php' name='editUser' id='editUser'>			<td><input type='hidden' value='$userId' name='userId' id='UserId'></td>			<td class='standard_table_data'>$userId</td>			<td class='standard_table_data'>$username</td>			<td class='standard_table_data'>$mail</td>			<td class='standard_table_data'>$position_id</td>			<td class='standard_table_data'>$admin</td>			<td class='standard_table_data'>$ref_users</td>			<td></td>			<td></td>			<td></td>			<td><input type='submit' value='Endre' name='modifySubmit' id='modifySubmit'>		</form>				<form method='post' action='vis-brukere.php' name='deleteUser' id='deleteUser' onSubmit='return confirmDelete()'>			<td><input type='hidden' value='$ref_users' name='ref_users' id='ref_users'></td>			<td><input type='hidden' value='$username' name='username' id='username'></td>			<td><input type='submit' value='Slett' name='deleteSubmit' id='deleteSubmit'></td>		</form>				<form method='post' action='nytt-passord.php' name='passwordchange' id='passwordchange'>			<td><input type='hidden' value='$userId' name='userId' id='userId'></td>			<td><input type='submit' value='Endre Passord' name='newpassword' id='newpassword'></td>									</form>	</tr>		";	}}	disconnect();																			// KOBLER FRA}?>	</tbody>	<tfoot>		<tr>			<th></th>			<th></th>			<th></th>			<th></th>			<th></th>			<th></th>			<th></th>			<th></th>			<th></th>		</tr>	</tfoot></table><h2 class="marginTop40">Vis alle Brukere</h2> 	<table class="standard_table">		<thead >			<tr>				<th class="standard_table_header"></th>				<th class="standard_table_header" align=left>Id</th>				<th class="standard_table_header" align=left>Brukernavn</th>				<th class="standard_table_header" align=left>E-post</th>				<th class="standard_table_header" align=left>Brukergruppe</th>				<th class="standard_table_header" align=left>Admin</th>				<th class="standard_table_header" align=left>Brukeref.</th>				<th class="standard_table_header"></th>				<th class="standard_table_header"></th>			</tr>		</thead>		<tbody>		<br>		<br><?php /********************************** Vis alle Brukere **************************************/connect();//sql sp√∏rring - ulike filter legges til sql setningen ved at variabler f√•r verdi$sql= "Call showAllUsers";																	// VISER ALLE FRA BRUKER$result = mysql_query($sql) or die ("ikke mulig å hente rom fra databasen");				// FEILMELDING HVIS SPØRRINGEN FEILER$numRows = mysql_num_rows($result);for($t=1; $t<=$numRows; $t++){	$row=mysql_fetch_array($result);														$userId = $row[0];																			$username = $row[1];	$mail = $row[2];	$position_id = $row[4];	$admin=$row[5];	$ref_users=$row[6];		if($position_id==1) {																//GIR POSISJONEN MER LESBARE NAVN		$position_id = 'Ansatt';	} elseif ($position_id==2) {		$position_id = 'Student';	} else {		$position_id = 'tom';	}		if ($admin==1) {																	// GIR ADMIN EN ANNEN SYNLIG VERDI EN BOOL		$admin = 'Ja';	} else {		$admin = 'Nei';	}																									//TABELLEN TAR IN DATA OG LAGER KNAPPER 																									//FOR SLETT OG ENDRE	echo "	<tr>		<form method='post' action='endre-bruker.php' name='editUser' id='editUser'>			<td><input type='hidden' value='$userId' name='userId' id='UserId'></td>			<td class='standard_table_data'>$userId</td>			<td class='standard_table_data'>$username</td>			<td class='standard_table_data'>$mail</td>			<td class='standard_table_data'>$position_id</td>			<td class='standard_table_data'>$admin</td>			<td class='standard_table_data'>$ref_users</td>			<td></td>			<td></td>			<td></td>			<td><input type='submit' value='Endre' name='modifySubmit' id='modifySubmit'>		</form>				<form method='post' action='vis-brukere.php' name='deleteUser' id='deleteUser' onSubmit='return confirmDelete()'>			<td><input type='hidden' value='$ref_users' name='ref_users' id='ref_users'></td>			<td><input type='hidden' value='$username' name='username' id='username'></td>			<td><input type='submit' value='Slett' name='deleteSubmit' id='deleteSubmit'></td>					</form>		<form method='post' action='nytt-passord.php' name='passwordchange' id='passwordchange'>			<td><input type='hidden' value='$userId' name='userId' id='userId'></td>			<td><input type='submit' value='Endre Passord' name='newpassword' id='newpassword'></td>									</form>	</tr>	";	}	disconnect();																								//KOBLER FRA DATABASEN?>		</tbody> 			<tfoot>			<tr>				<th></th>				<th></th>				<th></th>				<th></th>				<th></th>				<th></th>			</tr>		</tfoot>	</table>	<input type='submit' value='Oppdater side' onClick='document.location.reload(true)'>						<!-- LAGER KNAPP SOM RESETER SIDEN -->	<?php/********************************* Slette Bruker **************************************/$deleteSubmit=$_POST['deleteSubmit'];if($deleteSubmit){	$ref_users = $_POST['ref_users'];	$usename = $_POST['username'];		connect();	$sql="CALL deleteUserAndBooking('$ref_users');";											// SLETTER FRA BOOKING TABELLEN	$result = mysql_query($sql) or die ("ikke mulig å slette bruker fra databasen");						//FEILMELDING SOM RETURNERES VED FEIL MED SPØRRING	disconnect();																							//KOBLER FRASQL DATABASEB		echo "<script> alert('Brukeren er nå slettet')</script>";							// ALERTBOX på at BRUKER ER SLETTET}?><?php																										//INKLUDERER SISTE DEL AV DESIGNET include '../includes/footerVedlikehold.php';?>	